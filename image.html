<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Poster CNN Nasional</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@700;800&display=swap" rel="stylesheet" />
  <script src="https://unpkg.com/html-to-image"></script>
  <style>
body {
  margin: 0;
  padding: 0;
  overflow-x: hidden;
}

    #updateDate {
      margin-bottom: 10px;
      color: #facc15;
    }

    .post-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin-bottom: 40px;
    }

    .post-card {
      background: #1e293b;
    border-radius: 10px;
    overflow: hidden;
    color: #fff;
    cursor: pointer;
    transition: 0.2s;
    }

    .post-card:hover {
      transform: scale(1.02);
    }

    .post-card img {
      width: 100%;
      height: 160px;
      object-fit: cover;
    }

    .post-card .title {
      padding: 12px;
      font-size: 14px;
      font-weight: bold;
    }

    .buttons {
      margin-bottom: 20px;
    }

    .buttons button {
      padding: 10px 18px;
      margin: 0 10px;
      font-size: 14px;
      border: none;
      border-radius: 8px;
      background: #3b82f6;
      color: white;
      cursor: pointer;
      font-weight: bold;
    }

#output {
  position: relative;
  width: 1080px;
  height: 1350px;
  margin: 40px auto;
  border-radius: 20px;
  overflow: hidden;
  display: none;
  box-shadow: 0 0 20px rgba(0,0,0,0.4);
  background: #000; /* tambahan agar tidak transparan */
}


    #bgImage {
      position: absolute;
      width: 100%;
      height: 100%;
      object-fit: cover;
      top: 0;
      left: 0;
      z-index: 1;
    }

    .bg-overlay {
      position: absolute;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.35);
      z-index: 2;
    }

   .bottom-gradient {
  position: absolute;
  bottom: 0;
  width: 100%;
  height: 20%;
  background: linear-gradient(to top, rgba(15,23,42,0.85), transparent);
  z-index: 2;
}
.judul-container {
  position: absolute;
  bottom: 200px;
  width: 100%;
  padding: 0 40px;
  z-index: 4;
  text-align: left;
}


    .cnn-logo {
      position: absolute;
      top: 32px;
      left: 32px;
      width: 120px;
      z-index: 3;
    }

    .judul-container {
      position: absolute;
      bottom: 160px;
      width: 100%;
      padding: 0 40px;
      z-index: 3;
      text-align: left;
    }

    .judul-bg {
      background: rgba(15, 23, 42, 0.85);
      display: inline-block;
      padding: 24px 32px;
      border-radius: 16px;
      max-width: 100%;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }

   .judul-bg span {
    font-size: 70px;
    font-weight: 800;
    color: #fff;
    line-height: 1.1;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

    .watermark-domain {
      position: absolute;
      bottom: 60px;
      left: 40px;
      display: flex;
      align-items: center;
     font-size: 24px;
      font-weight: bold;
      color: #facc15;
      z-index: 3;
    }

    .watermark-domain img {
      width: 24px;
      height: 24px;
      margin-right: 8px;
    }

    #output.loading::before {
      content: "Memuat gambar HD...";
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(15,23,42,0.9);
      padding: 20px 40px;
      border-radius: 10px;
      font-size: 20px;
      z-index: 5;
    }.bottom-gradient {
  height: 20%; /* atau kurang dari 30% */
}
.judul-container {
  position: absolute;
  bottom: 140px;
  left: 0;
  right: 0;
  padding: 0 40px;
  z-index: 4;
  text-align: left;
  box-sizing: border-box;
}

.judul-bg {
  background: rgba(15, 23, 42, 0.85);
  display: inline-block;
  padding: 20px 28px;
  border-radius: 16px;
  max-width: 100%;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
  word-wrap: break-word;
  overflow-wrap: break-word;
}

  .judul-bg span {
    font-size: 70px;
    font-weight: 800;
    color: #fff;
    line-height: 1.1;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}
.judul-bg span {
  display: block;
  white-space: normal;
}
.custom-logo {
  position: absolute;
  top: 32px;
  left: 32px;
  z-index: 3;
  font-family: 'Inter', sans-serif;
  font-size: 40px;
  font-weight: 900;
  background: rgba(15,23,42,0.8);
  padding: 10px 20px;
  border-radius: 12px;
  box-shadow: 0 4px 16px rgba(0,0,0,0.4);
  display: inline-block;
}

.custom-logo .blue {
  color: #38bdf8;
}

.custom-logo .yellow {
  color: #fde047;
}


  </style>
</head>
<body>
  <h1>Poster Berita CNN Nasional</h1>
  <div id="updateDate"></div>
  <div class="post-list" id="postList"></div>
  <div class="buttons">
  <button id="downloadBtn">Download Poster (HD)</button>
  <button id="copyBtn">Copy Isi Berita</button>
  <button id="loadMoreBtn">Load More</button> <!-- NEW -->
</div>
<div style="display: flex; justify-content: center;"></div>
  <div id="output">
    <img id="bgImage" src="" alt="Background"/>
    <div class="bg-overlay"></div>
    <div class="bottom-gradient"></div>
<div class="custom-logo">
  <span class="blue">808</span><span class="yellow">News</span>
</div>

    <div class="judul-container">
      <div class="judul-bg">
        <span id="judulPreview">Judul Berita</span>
      </div>
    </div>
    <div class="watermark-domain">
      <img src="https://cdn-icons-png.flaticon.com/512/10453/10453141.png" alt="Icon" />
      <span>www.score808.my.id</span>
    </div>
  </div>
</div>
  <script>
    let selectedContent = '';
let allItems = []; // untuk simpan semua data item
let itemsPerPage = 6;
let currentIndex = 0;

    function stripHtmlTags(html) {
      const div = document.createElement('div');
      div.innerHTML = html;
      return div.innerText;
    }

    function loadXMLFeed() {
      const url = 'https://www.cnnindonesia.com/olahraga/rss';
      fetch(url)
        .then(response => response.text())
        .then(data => {
          let parser = new DOMParser();
          let xml = parser.parseFromString(data, 'application/xml');
          displayFeedList(xml);
        });
    }

    document.addEventListener('DOMContentLoaded', loadXMLFeed);

function displayFeedList(x) {
  const items = Array.from(x.getElementsByTagName('item'));
  const updateDate = document.getElementById('updateDate');
  updateDate.innerHTML = '🕒 Diperbarui: ' + new Date(x.getElementsByTagName('lastBuildDate')[0].textContent).toLocaleString();
  
  allItems = items;
  currentIndex = 0;
  document.getElementById('postList').innerHTML = ''; // bersihkan list
  showNextItems();
}
function showNextItems() {
  const list = document.getElementById('postList');
  const nextItems = allItems.slice(currentIndex, currentIndex + itemsPerPage);

  nextItems.forEach(item => {
    const title = item.getElementsByTagName('title')[0].textContent;
    const link = item.getElementsByTagName('link')[0].textContent;
    const description = item.getElementsByTagName('description')[0].textContent;
    const match = description.match(/<img[^>]+src=["']([^"'>]+)["']/);
    const img = match ? match[1] : "https://via.placeholder.com/1080x1350";
    const card = document.createElement('div');
    card.className = 'post-card';
    card.innerHTML = `<img src="${img}"/><div class="title">${title}</div>`;
    card.addEventListener('click', () => showPoster(title, img, description, link));
    list.appendChild(card);
  });

  currentIndex += itemsPerPage;

  if (currentIndex >= allItems.length) {
    document.getElementById('loadMoreBtn').style.display = 'none';
  } else {
    document.getElementById('loadMoreBtn').style.display = 'inline-block';
  }
}

    async function showPoster(title, fallbackImg, content, link) {
      const outputEl = document.getElementById('output');
      outputEl.classList.add('loading');
      try {
        const res = await fetch(link);
        const html = await res.text();
        const doc = new DOMParser().parseFromString(html, 'text/html');
        const ogImg = doc.querySelector('meta[property="og:image"]')?.content;

        const finalImg = ogImg || fallbackImg;
        const proxy = 'https://images.weserv.nl/?url=' + encodeURIComponent(finalImg) + '&w=1080&h=1350&fit=cover&output=jpg&sharp=1';

        const bgImage = document.getElementById("bgImage");
        bgImage.onload = () => {
  outputEl.style.display = 'block';
  document.getElementById("judulPreview").textContent = title;
  outputEl.classList.remove('loading');
  selectedContent = content;
};

        bgImage.onerror = () => {
          outputEl.classList.remove('loading');
          alert("Gagal memuat gambar.");
        };
bgImage.src = proxy + '&t=' + Date.now(); // tambahkan timestamp supaya unik
      } catch (err) {
        outputEl.classList.remove('loading');
        alert("Gagal mengambil og:image dari halaman.");
      }
    }

    document.getElementById("downloadBtn").addEventListener('click', () => {
      const outputEl = document.getElementById('output');
    htmlToImage.toPng(outputEl, {
  pixelRatio: 2,
  cacheBust: true,
  style: {
    margin: '0',
    padding: '0',
    boxSizing: 'border-box',
  }
})

        .then(dataUrl => {
          const link = document.createElement('a');
          link.download = '808-news-hd.png';
          link.href = dataUrl;
          link.click();
        })
        .catch(err => {
          alert('❌ Gagal membuat gambar. Pastikan gambar berhasil dimuat.');
          console.error(err);
        });
    });

    document.getElementById("copyBtn").addEventListener('click', () => {

      if (!selectedContent) return alert('Pilih artikel dulu.');
      const plainText = stripHtmlTags(selectedContent).trim().substring(0, 300);
      const textWithPrefix = '🗞️ BERITA 808NEWS - ' + plainText + '\n\n#Olahraga #BeritaNasional #BreakingNews';
      navigator.clipboard.writeText(textWithPrefix).then(() => {
        alert('Berita berhasil disalin!');
      });
    });
 document.getElementById("loadMoreBtn").addEventListener('click', showNextItems);
 </script>
</body>
</html>
